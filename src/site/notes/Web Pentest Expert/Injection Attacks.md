---
{"dg-publish":true,"permalink":"/web-pentest-expert/injection-attacks/"}
---


### XPath Injection
XML Path Language (XPath), SQL'in veritabanları için bir sorgu dili olmasına benzer şekilde, Extensible Markup Language (XML) verileri için bir sorgu dilidir. Bu nedenle XPath, XML dökümanlarındaki verileri sorgulamak için kullanılır. XML formatında saklanan verileri alması gereken web uygulamaları, gerekli verileri almak için XPath'e güvenir. [XPath Enjeksiyonu](https://owasp.org/www-community/attacks/XPATH_Injection) güvenlik açıkları, kullanıcı girdisi uygun şekilde temizlenmeden XPath sorgularına eklendiğinde ortaya çıkar. SQLi güvenlik açıkları gibi, XPath enjeksiyonu da tüm verileri tehlikeye atar, çünkü XPath enjeksiyonundan başarılı bir şekilde yararlanmak bir saldırganın tüm XML dokümanını almasına izin verir.


### LDAP Enjeksiyonu 
Lightweight Directory Access Protocol (LDAP), Active Directory ( AD ) gibi dizin sunucularına erişmek için kullanılan bir protokoldür. Web uygulamaları genellikle AD servisiyle entegrasyonu sağlamak için LDAP sorgularını kullanır. Örneğin, LDAP AD kullanıcılarının web uygulamasına kimlik doğrulaması yapmasını sağlayabilir. LDAP enjeksiyon güvenlik açıkları, kullanıcı girdisi arama filtrelerine uygun temizleme yapılmadan eklendiğinde ortaya çıkar. LDAP kimlik doğrulaması yanlış uygulanırsa bu durum kimlik doğrulama atlamalarına yol açabilir. Ayrıca, LDAP enjeksiyonu veri kaybına yol açabilir.


### PDF Oluşturucularda HTML Enjeksiyonu 
Portable Document Format (PDF) dosyaları belgelerin dağıtımı için yaygın olarak kullanılmaktadır. Bu nedenle, birçok web uygulaması PDF oluşturma kütüphaneleri yardımıyla verileri PDF formatına dönüştürme fonksiyonunu uygular. Bu kütüphaneler HTML kodunu girdi olarak okur ve ondan bir PDF dosyası oluşturur. Bu, web uygulamasının giriş HTML koduna stil sayfaları uygulayarak oluşturulan PDF dosyasına özel stiller ve biçimler uygulamasına olanak tanır. Genellikle, kullanıcı girdisi doğrudan bu oluşturulan PDF dosyalarına dahil edilir. Kullanıcı girdisi doğru şekilde sterilize edilmezse, PDF oluşturma kütüphanelerinin girdisine HTML kodu enjekte etmek mümkündür, bu da ==Server-Side Request Forgery ( SSRF)== ve ==Local File Inclusion ( LFI )== dahil olmak üzere birden fazla güvenlik açığına yol açabilir.


### Introduction to XPath Injection
XML Path Language (XPath) Extensible Markup Language (XML) verileri için bir sorgu dilidir. Özellikle, XML biçiminde depolanan veriler için XPath sorguları oluşturmak üzere XPath'i kullanabiliriz. Kullanıcı girdisi XPath sorgularına uygun şekilde temizlenmeden eklenirse, SQL Injection güvenlik açıklarına benzer XPath Injection güvenlik açıkları ortaya çıkar.


### XPath Temelleri
XPath'e dalmak için öncelikle XPath terminolojisinde bir temel oluşturmamız gerekir. Bunu yapmak için aşağıdaki XML belgesini ele alalım:

![Pasted image 20241125101906.png](/img/user/resimler/Pasted%20image%2020241125101906.png)

Bir XML belgesi genellikle XML sürümünü ve kodlamasını belirten XML bildirimi ile başlar. Yukarıdaki XML belgesinde, XML bildirimi <?xml version=“1.0” encoding=“UTF-8”?> şeklindedir. Bildirim atlanırsa, XML çözümleyici 1.0 sürümünü ve UTF-8 kodlamasını varsayar.

Bir XML belgesindeki veriler, en üst öğesi root element düğümü olarak adlandırılan düğümlerden oluşan bir ağaç yapısında biçimlendirilir. Bizim durumumuzda, root düğümü academy_modules düğümüdür. Ayrıca, module ve title gibi element düğümleri ve co-author=“LTNB0B” veya difficulty=“medium” gibi öznitelik düğümleri vardır. Ayrıca, bu bir yorumdur gibi yorumlar içeren yorum düğümleri ve örneğimizdeki Web Saldırıları ve LTNB0B gibi eleman veya nitelik düğümlerinden karakter verileri içeren text düğümleri vardır. Ayrıca burada ele almayacağımız namespace düğümleri ve processing instruction düğümleri de vardır ve toplamda 7 farklı düğüm tipi bulunmaktadır

XML belgeleri bir ağaç yapısı oluşturduğundan, her öğe ve attribute düğümü tam olarak bir parent düğüme sahipken, her öğe düğümü isteğe bağlı sayıda child düğüme sahip olabilir. Aynı parent'e sahip düğümlere kardeş düğümler denir. Tüm parent düğümleri veya torun düğümleri belirlemek için ağacı belirli bir düğümden yukarı veya aşağı doğru gezebiliriz.