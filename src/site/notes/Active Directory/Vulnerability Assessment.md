---
{"dg-publish":true,"permalink":"/active-directory/vulnerability-assessment/"}
---


# Nessus

## Vulnerability Scanning Overview

Güvenlik açığı taraması genellikle standart bir sızma testinin parçasıdır, ancak ikisi aynı şey değildir. Güvenlik açığı taraması, bir sızma testi sırasında ek kapsam elde edilmesine yardımcı olabilir veya zaman kısıtlamaları altında projenin testini hızlandırabilir. Gerçek bir sızma testi, taramadan çok daha fazlasını içerir.

Yürütülen taramaların türü bir araçtan diğerine değişir, ancak çoğu araç hedefe ve güvenlik açığına bağlı olarak `dinamik ve statik testlerin bir kombinasyonunu yürütür`. `Statik bir test`, belirli bir varlığın tanımlanan sürümünün herkese açık bir CVE'ye sahip olması durumunda bir güvenlik açığı belirleyecektir. Ancak, bir yama uygulanmış olabileceğinden veya hedef söz konusu CVE'ye karşı özellikle savunmasız olmadığından bu her zaman doğru değildir. Öte yandan, `dinamik` bir `test`, hedefte (örneğin bir web uygulaması) zayıf kimlik bilgileri, SQL enjeksiyonu veya komut enjeksiyonu gibi belirli (genellikle iyi huylu) payload'ları dener. Herhangi bir payload bir isabet döndürürse, o zaman savunmasız olma ihtimali yüksektir.

Kuruluşlar, yeni güvenlik açıkları keşfedildikçe varlıkların yamalandığından ve ağa eklenen yeni varlıkların eksik yamaları veya diğer yapılandırma/yama sorunları olmadığından emin olmak için hem kimliği doğrulanmamış hem de `kimliği doğrulanmış taramaları` sürekli bir programda çalıştırmalıdır. Güvenlik açığı taraması bir kuruluşun [yama yönetimi](https://en.wikipedia.org/wiki/Patch_(computing)) programını beslemelidir.

`Nessus`, `Nexpose` ve `Qualys`, ücretsiz topluluk sürümleri de sağlayan iyi bilinen güvenlik açığı tarama platformlarıdır. `OpenVAS` gibi açık kaynak alternatifleri de vardır.


## **Nessus'a Genel Bakış**  

[Nessus Essentials](https://community.tenable.com/s/article/Nessus-Essentials) by Tenable, resmi Nessus Güvenlik Açığı Tarayıcısının ücretsiz sürümüdür. Bireyler Tenable'ın güvenlik açığı tarayıcısını anlamaya başlamak için Nessus Essentials'a erişebilirler. Uyarı, yalnızca 16 host'a kadar kullanılabilmesidir. Ücretsiz sürümdeki özellikler sınırlıdır, ancak Nessus ile başlamak isteyen biri için mükemmeldir. Ücretsiz tarayıcı bir ortamdaki güvenlik açıklarını tespit etmeye çalışacaktır.

![Pasted image 20241108110537.png](/img/user/resimler/Pasted%20image%2020241108110537.png)


## OpenVAS Overview
Greenbone Networks tarafından sunulan[OpenVAS](https://www.openvas.org/), halka açık bir açık kaynak güvenlik açığı tarayıcısıdır. OpenVAS, kimliği doğrulanmış ve doğrulanmamış testler dahil olmak üzere ağ taramaları gerçekleştirebilir.

![Pasted image 20241108110559.png](/img/user/resimler/Pasted%20image%2020241108110559.png)


## **Nessus'u İndirme**  

Nessus'u indirmek için, sistemimiz için doğru Nessus binary'sini indirmek üzere [Download Page](“https://www.tenable.com/downloads/nessus?loginAttempted=true”) 'e gidebiliriz. Bu kılavuz için `Ubuntu` için Debian paketini indireceğiz.

![Pasted image 20241108124344.png](/img/user/resimler/Pasted%20image%2020241108124344.png)

## **Ücretsiz Lisans Talep Etme**  

Ardından, Nessus'un ücretsiz sürümünü edinmek için gerekli olan Nessus Aktivasyon Kodunu talep etmek için Aktivasyon [Kodu Sayfasını](https://www.tenable.com/products/nessus/activation-code) ziyaret edebiliriz:

![Pasted image 20241108124403.png](/img/user/resimler/Pasted%20image%2020241108124403.png)

![Pasted image 20241108124408.png](/img/user/resimler/Pasted%20image%2020241108124408.png)

## **Paket Yükleme**

```shell-session
M1R4CKCK@htb[/htb]$ dpkg -i Nessus-8.15.1-ubuntu910_amd64.deb

Selecting previously unselected package nessus.
(Reading database ... 132030 files and directories currently installed.)
Preparing to unpack Nessus-8.15.1-ubuntu910_amd64.deb ...
Unpacking nessus (8.15.1) ...
Setting up nessus (8.15.1) ...
Unpacking Nessus Scanner Core Components...
Created symlink /etc/systemd/system/nessusd.service → /lib/systemd/system/nessusd.service.
Created symlink /etc/systemd/system/multi-user.target.wants/nessusd.service → /lib/systemd/system/nessusd.service.
```

## **Starting Nessus**
```shell-session
M1R4CKCK@htb[/htb]$ sudo systemctl start nessusd.service
```


## **Nessus'a Erişme**  

Nessus'a erişmek için `https://localhost:8834` adresine gidebiliriz. Kurulum sayfasına geldiğimizde, ücretsiz sürüm için `Nessus Essentials` 'ı seçmeliyiz ve ardından aktivasyon kodumuzu girebiliriz:

![Pasted image 20241108124535.png](/img/user/resimler/Pasted%20image%2020241108124535.png)

Aktivasyon kodumuzu girdikten sonra, Nessus hesabımız için `güvenli` bir parolaya sahip bir kullanıcı ayarlayabiliriz. Bu adım tamamlandıktan sonra eklentiler derlenmeye başlayacaktır:

![Pasted image 20241108124557.png](/img/user/resimler/Pasted%20image%2020241108124557.png)

Son olarak, kurulum tamamlandıktan sonra taramalar, tarama ilkeleri, eklenti kuralları oluşturmaya ve ayarları özelleştirmeye başlayabiliriz. `Settings` sayfasında Proxy Server veya SMTP sunucusu kurma, standart hesap yönetimi seçenekleri ve kullanıcı arayüzünü, taramayı, günlüğe kaydetmeyi, performansı ve güvenlik seçeneklerini özelleştirmek için gelişmiş ayarlar gibi çok sayıda seçenek vardır.

![Pasted image 20241108124657.png](/img/user/resimler/Pasted%20image%2020241108124657.png)

# **Nessus Taraması**  

Yeni bir Nessus taraması, `New Scan (Yeni Tarama`) tıklanarak ve bir tarama türü seçilerek yapılandırılabilir. Tarama şablonları üç kategoriye ayrılır: `Discovery (Keşif`), `Vulnerabilities`( `Güvenlik Açıkları`) ve `Compliance (Uyumluluk`).

## **New Scan**  

Burada, canlı `hostları/açık` portları belirlemek için temel `Host Discovery` taraması veya `Basic Network Scan`, `Advanced Scan`, `Malware` Scan , `Web Application Tests` gibi çeşitli tarama türlerinin yanı sıra belirli CVE'leri ve denetim ve uyumluluk standartlarını hedefleyen taramalar için seçeneklerimiz bulunmaktadır. Her bir tarama türünün açıklamasını [burada](https://docs.tenable.com/nessus/Content/ScanAndPolicyTemplates.htm) bulabilirsiniz.

![Pasted image 20241108124920.png](/img/user/resimler/Pasted%20image%2020241108124920.png)

Bu alıştırmanın amaçları doğrultusunda, `Basic Network Scan (Temel Ağ Taraması` ) seçeneğini seçeceğiz ve hedeflerimizi girebiliriz:

![Pasted image 20241108124947.png](/img/user/resimler/Pasted%20image%2020241108124947.png)

**Not:** Bu modül için Windows hedefi `172.16.16.100` ve Linux hedefi `172.16.16.160` olacaktır.

## **Discovery**  

`Discovery` bölümünde, `Host Discovery` altında, hassas cihazlar için taramayı etkinleştirme seçeneği sunulur. Ağ yazıcıları gibi aygıtların taranması genellikle aygıtların kullanılamaz hale gelmesine neden olan çöp metinli kağıt tomarları yazdırmalarına neden olur. Bu ayarı devre dışı bırakabiliriz:

![Pasted image 20241108125042.png](/img/user/resimler/Pasted%20image%2020241108125042.png)

`Port Tarama`'da, gereksinimlerimize bağlı olarak genel portları, tüm portları veya kendi tanımladığımız bir aralığı taramayı seçebiliriz:

![Pasted image 20241108125114.png](/img/user/resimler/Pasted%20image%2020241108125114.png)

`Service Discovery` alt bölümünde, `Probe all ports to find services` seçeneği varsayılan olarak seçilidir. Kötü tasarlanmış bir uygulama veya hizmetin bu tarama sonucunda çökmesi mümkündür, ancak çoğu uygulama bununla başa çıkabilecek kadar sağlam olmalıdır. SSL/TLS hizmetlerinin aranması da özel bir taramada varsayılan olarak etkinleştirilir ve Nessus'a ayrıca süresi dolan ve iptal edilen sertifikaları belirlemesi talimatı verilebilir.


## **Assessment**  

`Assessment (Değerlendirme` ) kategorisi altında, gerekirse web uygulaması taraması da etkinleştirilebilir ve özel bir kullanıcı aracısı ve çeşitli diğer web uygulaması tarama seçenekleri belirtilebilir (örneğin, Remote File Inclusion (RFI) testi için bir URL):

![Pasted image 20241108125215.png](/img/user/resimler/Pasted%20image%2020241108125215.png)

İstenirse, Nessus sağlanan kimlik bilgilerini kullanarak keşfedilen uygulamalara ve hizmetlere karşı kimlik doğrulaması yapmayı deneyebilir (kimlik doğrulamalı bir tarama çalıştırıyorsa) veya sağlanan kullanıcı adı ve parola listeleriyle brute-force saldırısı gerçekleştirebilir:

![Pasted image 20241108125257.png](/img/user/resimler/Pasted%20image%2020241108125257.png)

Kullanıcı numaralandırma, RID Brute Forcing gibi çeşitli teknikler kullanılarak da gerçekleştirilebilir:

![Pasted image 20241108125510.png](/img/user/resimler/Pasted%20image%2020241108125510.png)

RID Brute Forcing gerçekleştirmeyi tercih edersek, hem domain hem de local kullanıcı hesapları için başlangıç ve bitiş UID'lerini ayarlayabiliriz:

![Pasted image 20241108125554.png](/img/user/resimler/Pasted%20image%2020241108125554.png)

## **Advanced**  

`Advanced (Gelişmiş` ) sekmesinde, güvenli denetimler varsayılan olarak etkindir. Bu, Nessus'un hedef cihazı veya ağı olumsuz etkileyebilecek kontrolleri çalıştırmasını önler. Ayrıca, Nessus herhangi bir ağ tıkanıklığı tespit ederse taramayı yavaşlatmayı veya azaltmayı, yanıt vermeyen bir hostu taramaya çalışmayı durdurmayı ve hatta Nessus'un hedef IP listemizi rastgele sırayla taramasını seçebiliriz:

![Pasted image 20241108125831.png](/img/user/resimler/Pasted%20image%2020241108125831.png)


# **Advanced Settings**  

Nessus ve taramaları için tarama politikaları, eklentiler ve kimlik bilgileri gibi bir dizi gelişmiş ayar yapılandırabiliriz, bunların hepsini bu bölümde ele alacağız.

## **Scan Policies**

Nessus bize tarama politikaları oluşturma seçeneği sunar. Esasen bunlar, belirli tarama seçeneklerini tanımlamamıza, ilke yapılandırmasını kaydetmemize ve yeni bir tarama oluştururken `Scan Templates` altında bunları kullanmamıza olanak tanıyan özelleştirilmiş taramalardır. Bu bize daha yavaş, daha kaçamaklı bir tarama, web odaklı bir tarama veya bir veya birkaç kimlik bilgisi seti kullanarak belirli bir istemci için bir tarama gibi herhangi bir sayıda senaryo için hedefli taramalar oluşturma yeteneği verir. Tarama ilkeleri diğer Nessus tarayıcılarından içe aktarılabilir veya daha sonra başka bir Nessus tarayıcısına aktarılmak üzere dışa aktarılabilir.

![Pasted image 20241108130111.png](/img/user/resimler/Pasted%20image%2020241108130111.png)


## **Scan Policy Oluşturma**  

Bir tarama ilkesi oluşturmak için, sağ üstteki `New Policy` düğmesine tıklayabiliriz ve önceden yapılandırılmış taramaların listesi bize sunulacaktır. `Basic Network Scan (Temel Ağ Taraması`) gibi bir tarama seçebilir, ardından bunu özelleştirebilir ya da kendi taramamızı oluşturabiliriz. Yerleşik önceden yapılandırılmış öneriler olmadan tamamen özelleştirilmiş bir tarama oluşturmak için `Advanced Scan'i (Gelişmiş Tarama` ) seçeceğiz.  

Tarama türünü temel olarak seçtikten sonra, tarama ilkesine bir ad ve gerekirse bir açıklama verebiliriz:

![Pasted image 20241108130238.png](/img/user/resimler/Pasted%20image%2020241108130238.png)

Buradan ayarları yapılandırabilir, gerekli kimlik bilgilerini ekleyebilir ve taramayı çalıştırmak için herhangi bir uyumluluk standardı belirleyebiliriz. Ayrıca tüm [eklenti](https://docs.tenable.com/nessus/Content/Plugins.htm) ailelerini veya tek tek eklentileri etkinleştirmeyi veya devre dışı bırakmayı da seçebiliriz.  

Taramayı özelleştirmeyi tamamladıktan sonra `Save (Kaydet`) düğmesine tıklayabiliriz ve yeni oluşturulan ilke ilkeler listesinde görünecektir. Bundan sonra, yeni bir tarama oluşturmaya gittiğimizde, `Scan Templates (Tarama Şablonları` ) altında `User Defined (Kullanıcı Tanımlı` ) adında yeni bir sekme olacak ve tüm özel tarama politikalarımızı gösterecektir:

![Pasted image 20241108130353.png](/img/user/resimler/Pasted%20image%2020241108130353.png)


## **Nessus Plugins**  

Nessus, [Nessus Attack Scripting Language (NASL)](https://en.wikipedia.org/wiki/Nessus_Attack_Scripting_Language) ile yazılmış eklentilerle çalışır ve yeni güvenlik açıklarını ve CVE'leri hedefleyebilir. Bu eklentiler, güvenlik açığı adı, etkisi, düzeltme ve belirli bir sorunun varlığını test etmenin bir yolu gibi bilgiler içerir.  

Pluginler önem derecesine göre derecelendirilir: `Kritik`, `Yüksek`, `Orta`, `Düşük`, `Bilgi`. Bu yazının yazıldığı sırada Tenable, `58.391` CVE ID'sini ve `30.696` [Bugtraq](https://en.wikipedia.org/wiki/Bugtraq) ID'sini kapsayan `145.973` eklenti yayınlamıştır. Yayınlanan tüm eklentilerin aranabilir bir veritabanı [Tenable web sitesinde](https://www.tenable.com/plugins) bulunmaktadır.

`Plugins` sekmesi, hafifletme de dahil olmak üzere belirli bir tespit hakkında daha fazla bilgi sağlar. Yinelenen taramalar yapılırken, daha fazla inceleme yapıldığında sorun olarak görülmeyen bir güvenlik açığı/tespit olabilir. Örneğin, Microsoft DirectAccess (İnternet üzerinden istemcilere dahili ağ bağlantısı sağlayan bir teknoloji) güvensiz ve null şifre takımlarına izin verir. Aşağıda `sslscan` ile yapılan tarama, güvensiz ve null şifre takımlarına bir örnek göstermektedir:

```shell-session
M1R4CKCK@htb[/htb]$ sslscan example.com

<SNIP>

Preferred TLSv1.0  128 bits  ECDHE-RSA-AES128-SHA          Curve 25519 DHE 253
Accepted  TLSv1.0  256 bits  ECDHE-RSA-AES256-SHA          Curve 25519 DHE 253
Accepted  TLSv1.0  128 bits  DHE-RSA-AES128-SHA            DHE 2048 bits
Accepted  TLSv1.0  256 bits  DHE-RSA-AES256-SHA            DHE 2048 bits
Accepted  TLSv1.0  128 bits  AES128-SHA                   
Accepted  TLSv1.0  256 bits  AES256-SHA                   

<SNIP>
```

Ancak, bu tasarım gereğidir. SSL/TLS bu durumda [gerekli](https://directaccess.richardhicks.com/2014/09/23/directaccess-ip-https-ssl-and-tls-insecure-cipher-suites/) değildir ve uygulanması olumsuz bir performans etkisine neden olur. Diğer hostlar için algılamayı aktif tutarken bu yanlış pozitif sonucu tarama sonuçlarından çıkarmak için bir plugin kuralı oluşturabiliriz:

![Pasted image 20241108130722.png](/img/user/resimler/Pasted%20image%2020241108130722.png)

`Resources (Kaynaklar` ) bölümü altında `Plugin Rules'u (Eklenti Kuralları`) seçebiliriz. Yeni plugin kuralında, Microsoft DirectAccess için Plugin ID ile birlikte hariç tutulacak host'u giriyoruz ve gerçekleştirilecek eylemi `Hide this result` olarak belirtiyoruz:

![Pasted image 20241108130856.png](/img/user/resimler/Pasted%20image%2020241108130856.png)

Ayrıca, doğrudan istismar edilemeyen sorunlar için eklentiler gibi belirli sorunları tarama sonuçlarımızdan hariç tutmak isteyebiliriz (örneğin, [SSL Kendinden İmzalı Sertifika](https://www.tenable.com/plugins/nessus/57582)). Bunu, hariç tutulacak plugin ID'sini ve host(lar)ı belirterek yapabiliriz:

![Pasted image 20241108130934.png](/img/user/resimler/Pasted%20image%2020241108130934.png)


## **Kimlik Bilgileri ile Tarama**  

Nessus ayrıca kimlik doğrulamalı taramayı destekler ve LM/NTLM hash'lerini, Kerberos kimlik doğrulamasını ve parola kimlik doğrulamasını destekleyerek çok fazla esneklik sağlar.  

Kimlik bilgileri, SSH üzerinden parola, public key, sertifika veya Kerberos tabanlı kimlik doğrulama ile host tabanlı kimlik doğrulama için yapılandırılabilir. Ayrıca parola, Kerberos, LM hash veya NTLM hash ile Windows host tabanlı kimlik doğrulaması için de yapılandırılabilir:

![Pasted image 20241108131128.png](/img/user/resimler/Pasted%20image%2020241108131128.png)

Nessus ayrıca Oracle, PostgreSQL, DB2, MySQL, SQL Server, MongoDB ve Sybase dahil olmak üzere çeşitli veritabanı türleri için kimlik doğrulamayı destekler:

![Pasted image 20241108131148.png](/img/user/resimler/Pasted%20image%2020241108131148.png)

Buna ek olarak, Nessus FTP, HTTP, IMAP, IPMI, Telnet ve daha fazlası gibi hizmetlere düz metin kimlik doğrulaması gerçekleştirebilir:

![Pasted image 20241108131329.png](/img/user/resimler/Pasted%20image%2020241108131329.png)

Son olarak, verilen kimlik bilgileriyle hedef uygulama veya hizmete kimlik doğrulamasının başarılı olup olmadığını doğrulamak için Nessus çıktısını kontrol edebiliriz:

![Pasted image 20241108131454.png](/img/user/resimler/Pasted%20image%2020241108131454.png)


# **Nessus Tarama Çıktısı ile Çalışma**  

Nessus bize tarama sonuçlarını çeşitli rapor formatlarında dışa aktarma seçeneğinin yanı sıra diğer araçlara aktarılacak, arşivlenecek veya Nessus tarafından tanımlanan tüm web uygulamalarının ekran görüntülerini almak için kullanılabilecek [EyeWitness](https://github.com/FortyNorthSecurity/EyeWitness) gibi araçlara aktarılacak ham Nessus tarama sonuçlarını dışa aktarma seçeneği sunar ve sonuçlar üzerinde çalışmamıza ve bunlarda daha fazla değer bulmamıza büyük ölçüde yardımcı olur.


## **Nessus Raporları**  

Tarama tamamlandıktan sonra `.pdf`, `.html` veya `.csv` formatlarında bir rapor dışa aktarmayı seçebiliriz. .pdf ve .html raporları Yönetici Özeti ya da özel bir rapor seçeneği sunar. Yönetici Özeti raporu, hostların bir listesini, host başına keşfedilen toplam güvenlik açığı sayısını ve keşfedilen her sorunun ciddiyetini, CVSS puanını, eklenti numarasını ve adını görmek için `Ayrıntıları Göster` seçeneğini sunar. Eklenti numarası, Tenable eklenti veritabanındaki tam eklenti yazısına bir bağlantı içerir. PDF seçeneği, tarama sonuçlarını paylaşılması daha kolay bir formatta sunar. CSV rapor seçeneği, hangi sütunları dışa aktarmak istediğimizi seçmemize olanak tanır. Bu, özellikle bir belgenin taranan çeşitli varlıkların düzeltilmesinden sorumlu birçok dahili paydaşla paylaşılması veya tarama verileri üzerinde analiz yapılması gerekiyorsa, tarama sonuçlarını Splunk gibi başka bir araca aktarırken kullanışlıdır.

![Pasted image 20241108132030.png](/img/user/resimler/Pasted%20image%2020241108132030.png)

**Not:** Bu tarama raporları yalnızca özel bir sızma testi/zafiyet değerlendirme raporuna ek veya tamamlayıcı veri olarak paylaşılmalıdır. Herhangi bir değerlendirme türü için nihai çıktı olarak müşteriye verilmemelidir.  

HTML raporunun bir örneği aşağıda gösterilmektedir:

![Pasted image 20241108132132.png](/img/user/resimler/Pasted%20image%2020241108132132.png)

Her bir sorunun ve etkilenen varlıkların net bir şekilde anlaşılması için güvenlik açıklarının her zaman birlikte gruplandırıldığından emin olmak en iyisidir.


## **Nessus Taramalarını Dışa Aktarma**  

Nessus ayrıca taramaları `Nessus (scan.nessus)` veya Nessus `DB (scan.db)` olmak üzere iki formatta dışa aktarma seçeneği sunar. `.nessus` dosyası bir `.xml` dosyasıdır ve tarama ayarlarının ve eklenti çıktılarının bir kopyasını içerir. `.db` dosyası `.nessus` dosyasını ve taramanın KB'sini, eklenti Denetim İzini ve tüm tarama eklerini içerir. `KB` ve `Denetim` İzi hakkında daha fazla bilgiyi [burada](“https://community.tenable.com/s/article/What-is-included-in-a-nessus-db-file”) bulabilirsiniz.  

[nessus-report-downloader](“https://raw.githubusercontent.com/eelsivart/nessus-report-downloader/master/nessus6-report-downloader.rb”) gibi komut dosyaları, tarama sonuçlarını Nessus REST API'sini kullanarak CLI'dan mevcut tüm formatlarda hızlı bir şekilde indirmek için kullanılabilir:

```shell-session
M1R4CKCK@htb[/htb]$ ./nessus_downloader.rb 

Nessus 6 Report Downloader 1.0

Enter the Nessus Server IP: 127.0.0.1
Enter the Nessus Server Port [8834]: 8834
Enter your Nessus Username: admin
Enter your Nessus Password (will not echo): 

Getting report list...
Scan ID Name                                               Last Modified                  Status         
------- ----                                               -------------                  ------         
1     Windows_basic                                Aug 22, 2020 22:07 +00:00      completed      
         
Enter the report(s) your want to download (comma separate list) or 'all': 1

Choose File Type(s) to Download: 
[0] Nessus (No chapter selection)
[1] HTML
[2] PDF
[3] CSV (No chapter selection)
[4] DB (No chapter selection)
Enter the file type(s) you want to download (comma separate list) or 'all': 3

Path to save reports to (without trailing slash): /assessment_data/inlanefreight/scans/nessus

Downloading report(s). Please wait...

[+] Exporting scan report, scan id: 1, type: csv
[+] Checking export status...
[+] Report ready for download...
[+] Downloading report to: /assessment_data/inlanefreight/scans/nessus/inlanefreight_basic_5y3hxp.csv

Report Download Completed!
```

Birçok Nessus özelliğini otomatikleştirmek için kendi komut dosyalarımızı da yazabiliriz.

# **Scanning Issues**  

Nessus iyi bilinen ve yaygın olarak kullanılan bir güvenlik açığı tarama platformudur. Ancak, bir taramaya başlamadan önce birkaç en iyi uygulama dikkate alınmalıdır. Taramalar hassas ağlarda sorunlara neden olabilir ve yanlış pozitifler verebilir, sonuç vermeyebilir veya ağ üzerinde olumsuz bir etkiye sahip olabilir. Olası sorunlardan kaçınmak için hassas/eski hostların tarama dışında bırakılıp bırakılmayacağı veya yüksek öncelikli/yüksek kullanılabilirlikli hostların ayrı olarak, normal çalışma saatleri dışında veya farklı tarama yapılandırmalarıyla taranıp taranmayacağı konusunda müşterinizle (veya kendi ağınıza karşı bir tarama yürütüyorsanız dahili paydaşlarınızla) iletişim kurmak her zaman en iyisidir.  

Bir taramanın beklenmedik sonuçlar verebileceği ve ince ayar yapılması gereken zamanlar da vardır.

## **Hafifletici Sorunlar**  

Bazı güvenlik duvarları, tüm portların açık olduğunu ya da hiçbir portun açık olmadığını gösteren tarama sonuçları almamıza neden olur. Böyle bir durumda, hızlı bir çözüm genellikle Advanced Scan (Gelişmiş Tarama) yapılandırmak ve `Ping the remote host (Uzak ana bilgisayara ping` at) seçeneğini devre dışı bırakmaktır. Bu, taramanın hostun "canlı" olduğunu doğrulamak için ICMP kullanmasını durduracak ve bunun yerine taramaya devam edecektir. Bazı güvenlik duvarları, Nessus'un canlı bir host olarak yorumlayacağı bir "ICMP Unreachable" mesajı döndürebilir ve birçok yanlış pozitif bilgi bulgusu sağlayabilir.  

Hassas ağlarda, etkiyi en aza indirmek için hız sınırlamasını kullanabiliriz. Örneğin, yaygın olarak kullanılan bir web uygulaması gibi hedef host genellikle ağır yük altındaysa `Performans Seçeneklerini` ayarlayabilir ve `Host Başına Maksimum Eşzamanlı Kontrolleri` değiştirebiliriz. Bu, hostta eşzamanlı olarak kullanılan eklenti sayısını sınırlayacaktır.  

Daha önceki bir bölümde gösterdiğimiz gibi, eski sistemleri taramaktan kaçınabilir ve yazıcıları taramama seçeneğini seçebiliriz. Bir host özellikle endişe vericiyse, hedef kapsamının dışında bırakılmalı veya `Nessus` taramalarını yapılandırmak için `nessusd.rules` dosyasını kullanabiliriz. Bu konuda daha fazla bilgiyi [burada](https://community.tenable.com/s/article/What-is-the-Nessus-rules-file?language=en_US) bulabilirsiniz.

Son olarak, özellikle talep edilmediği sürece, asla [Hizmet Reddi kontrolleri](https://www.tenable.com/plugins/nessus/families/Denial%20of%20Service) yapmamalıyız . Bir ağ arka plan programını çökertmek gibi bir hedef üzerinde olumsuz etkisi olabilecek herhangi bir ağ eklentisinden kaçınmak için taramalar gerçekleştirirken her zaman ["güvenli kontroller](https://www.tenable.com/blog/understanding-the-nessus-safe-checks-option) ” seçeneğini etkinleştirerek bu tür eklentilerin kullanılmamasını sağlayabiliriz. “Güvenli kontroller” seçeneğinin etkinleştirilmesi, bir Nessus güvenlik açığı taramasının sıfır olumsuz etkiye sahip olacağını garanti etmez, ancak potansiyel etkiyi önemli ölçüde en aza indirecek ve tarama süresini azaltacaktır.  

Bir taramaya başlamadan önce müşterilerimizle veya dahili paydaşlarımızla iletişim kurmak ve gerekli personeli uyarmak her zaman en iyisidir. Tarama tamamlandığında, araştırılması gereken bir olayın meydana gelmesi ihtimaline karşı tarama faaliyetinin ayrıntılı günlüklerini tutmalıyız.


## **Ağ Etkisi**  

Güvenlik açığı taramasının bir ağ üzerindeki, özellikle de düşük bant genişliği veya sıkışık bağlantılar üzerindeki potansiyel etkisini akılda tutmak da önemlidir. Bu, [vnstat](https://humdi.net/vnstat/) kullanılarak ölçülebilir:

```shell-session
M1R4CKCK@htb[/htb]$ sudo apt install vnstat
```

Bir Nessus taraması çalıştırmadan önce `eth0` ağ bağdaştırıcısını izleyelim:

```shell-session
M1R4CKCK@htb[/htb]$ sudo vnstat -l -i eth0

Monitoring eth0...    (press CTRL-C to stop)

   rx:       332 bit/s     0 p/s          tx:       332 bit/s     0 p/s

   rx:         0 bit/s     0 p/s          tx:         0 bit/s     0 p/s
   rx:         0 bit/s     0 p/s          tx:         0 bit/s     0 p/s^C

 eth0  /  traffic statistics

                           rx         |       tx
--------------------------------------+------------------
  bytes                        572 B  |           392 B
--------------------------------------+------------------
          max              480 bit/s  |       332 bit/s
      average              114 bit/s  |        78 bit/s
          min                0 bit/s  |         0 bit/s
--------------------------------------+------------------
  packets                          8  |               5
--------------------------------------+------------------
          max                  1 p/s  |           0 p/s
      average                  0 p/s  |           0 p/s
          min                  0 p/s  |           0 p/s
--------------------------------------+------------------
  time                    40 seconds
```

Bu sonucu, sadece bir host'a karşı bir Nessus taraması sırasında aynı arayüzü izlerken elde ettiğimiz sonuçla karşılaştırabiliriz:

```shell-session
M1R4CKCK@htb[/htb]$ sudo vnstat -l -i eth0

Monitoring eth0...    (press CTRL-C to stop)

   rx:   307.92 kbit/s   641 p/s          tx:   380.41 kbit/s   767 p/s^C

 eth0  /  traffic statistics

                           rx         |       tx
--------------------------------------+------------------
  bytes                     1.04 MiB  |        1.34 MiB
--------------------------------------+------------------
          max          414.81 kbit/s  |   480.59 kbit/s
      average          230.57 kbit/s  |   296.72 kbit/s
          min                0 bit/s  |         0 bit/s
--------------------------------------+------------------
  packets                      18252  |           22733
--------------------------------------+------------------
          max                864 p/s  |         969 p/s
      average                480 p/s  |         598 p/s
          min                  0 p/s  |           0 p/s
--------------------------------------+------------------
  time                    38 seconds


real  0m38.588s
user  0m0.002s
sys 0m0.016s
```

Sonuçları karşılaştırdığımızda, bir güvenlik açığı taraması sırasında aktarılan bayt ve paket sayısının oldukça önemli olduğunu ve doğru şekilde ayarlanmadığında veya kırılgan/hassas cihazlara karşı gerçekleştirilmediğinde bir ağı ciddi şekilde etkileyebileceğini görebiliriz.


# **Nessus Skills Assessment**

Soru 1 : Kimliği doğrulanmış Windows taramasından erişilebilen SMB paylaşımlarından birinin adı nedir? (Tek kelime)

Cevap : ==wsus==
![Pasted image 20241108134138.png](/img/user/resimler/Pasted%20image%2020241108134138.png)

Soru 2 : Kimliği doğrulanmış tarama için hedef neydi?
Cevap : 
![Pasted image 20241108134429.png](/img/user/resimler/Pasted%20image%2020241108134429.png)

Soru 3 : Windows kimliği doğrulanmış tarama için en yüksek kritikliğe sahip güvenlik açığının plugin ID'si nedir?
Cevap : 156032
![Pasted image 20241108135209.png](/img/user/resimler/Pasted%20image%2020241108135209.png)

Soru 4 : Windows kimliği doğrulanmış taramadan 26925 eklenti kimliğine sahip güvenlik açığının adı nedir? (Büyük/küçük harfe duyarlı)
Cevap : VNC Server Unauthenticated Access
![Pasted image 20241108135552.png](/img/user/resimler/Pasted%20image%2020241108135552.png)
![Pasted image 20241108135600.png](/img/user/resimler/Pasted%20image%2020241108135600.png)

Soru 5 : Kimliği doğrulanmış Windows taramasında VNC sunucusu hangi portta çalışıyor?
Cevap : 
![Pasted image 20241108135646.png](/img/user/resimler/Pasted%20image%2020241108135646.png)



# OpenVAS
Greenbone Networks tarafından geliştirilen[OpenVAS](https://openvas.org/), halka açık bir güvenlik açığı tarayıcısıdır. Greenbone Networks, bir parçası OpenVAS tarayıcısı olan bütün bir Güvenlik Açığı Yöneticisine sahiptir. Greenbone'un Zafiyet Yöneticisi de halka açıktır ve kullanımı ücretsizdir. OpenVAS, kimliği doğrulanmış ve doğrulanmamış testler de dahil olmak üzere ağ taramaları gerçekleştirme yeteneklerine sahiptir.

![Pasted image 20241108214653.png](/img/user/resimler/Pasted%20image%2020241108214653.png)

Parrot Security için aşağıdaki kurulum talimatlarını takip ederek OpenVAS kullanmaya başlayacağız. Araç, daha sonraki bir bölümde verilen host üzerine önceden yüklenmiştir.

## **Paket Yükleme**  

İlk olarak, aracı yükleyerek başlayabiliriz:

```shell-session
M1R4CKCK@htb[/htb]$ sudo apt-get update && apt-get -y full-upgrade
M1R4CKCK@htb[/htb]$ sudo apt-get install gvm && openvas
```

Ardından, yükleme işlemine başlamak için aşağıdaki komutu çalıştırabiliriz:

```shell-session
M1R4CKCK@htb[/htb]$ gvm-setup
```

Bu işlem kurulum sürecini başlatacak ve 30 dakika kadar sürecektir.

![Pasted image 20241108214748.png](/img/user/resimler/Pasted%20image%2020241108214748.png)

## **OpenVas'ı Başlatma**  

Son olarak, OpenVas'ı başlatabiliriz:

![Pasted image 20241108214800.png](/img/user/resimler/Pasted%20image%2020241108214800.png)


# OpenVAS Scan

OpenVAS Greenbone Security Assistant uygulamasında etkileşimde bulunabileceğiniz çeşitli sekmeler vardır. Bu bölüm için taramaları inceleyeceğiz. Aşağıda gösterilen `Scans` sekmesine giderseniz, geçmişte çalışmış olan taramaları göreceksiniz. Ayrıca bir taramayı çalıştırmak için yeni bir görevin nasıl oluşturulacağını da görebileceksiniz. Görevler, kullanıcının ayarladığı tarama konfigürasyonlarına göre çalışır.

![Pasted image 20241108215017.png](/img/user/resimler/Pasted%20image%2020241108215017.png)

**Not:** Bu modül için Windows hedefi `172.16.16.100` ve Linux hedefi `172.16.16.160` olacaktır.

![Pasted image 20241108215029.png](/img/user/resimler/Pasted%20image%2020241108215029.png)

## **Konfigürasyon**  

Herhangi bir taramayı ayarlamadan önce, tarama için hedefleri yapılandırmak en iyisidir. `Configurations (Yapılandırmalar` ) sekmesine gidip `Targets`( `Hedefler`) öğesini seçerseniz, uygulamaya zaten eklenmiş olan hedefleri görürsünüz.

![Pasted image 20241108215046.png](/img/user/resimler/Pasted%20image%2020241108215046.png)

Kendinizinkini eklemek için aşağıda vurgulanan simgeye tıklayın ve tek bir hedef veya bir host listesi ekleyin. Ayrıca portlar, kimlik doğrulama ve hostun erişilebilir olup olmadığını belirleme yöntemleri gibi diğer seçenekleri de yapılandırabilirsiniz. `Alive Test` için OpenVAS'ın `Scan Config Default` seçeneği `NVT Family'deki NVT` `Ping Host` 'tan yararlanır. NVT Ailesi hakkında [buradan](https://docs.greenbone.net/GSM-Manual/gos-22.04/en/scanning.html#creating-a-target) bilgi edinebilirsiniz.

![Pasted image 20241108215122.png](/img/user/resimler/Pasted%20image%2020241108215122.png)

Tipik olarak, `kimliği doğrulanmış bir tarama` `root` veya `Administrator` gibi yüksek ayrıcalıklı bir kullanıcıdan yararlanır. Kullanıcının izin seviyesine bağlı olarak, en yüksek izin seviyesi ise, tam erişime sahip olacağınızdan, mevcut güvenlik açıklarıyla ilgili olarak hostdan maksimum miktarda bilgi geri alırsınız.

Hedefinizi ekledikten sonra, aşağıdaki listede görüneceklerdir:

![Pasted image 20241108215210.png](/img/user/resimler/Pasted%20image%2020241108215210.png)

## **Tarama Ayarlama**  

Çoklu tarama yapılandırmaları, Windows, Linux, Web Uygulamaları vb. gibi birçok farklı güvenlik açığı kategorisinden oluşan OpenVAS Ağ Güvenlik Açığı Testi (NVT) Ailelerinden yararlanır. Aşağıda gösterilen birkaç farklı aile türünü görebilirsiniz:

![Pasted image 20241108215225.png](/img/user/resimler/Pasted%20image%2020241108215225.png)

OpenVAS, bir ağı taramak için seçilebilecek çeşitli tarama yapılandırmalarına sahiptir. Diğer seçenekler bir ağda sistem kesintilerine neden olabileceğinden, yalnızca aşağıdakilerden yararlanmanızı öneririz:  

- `Base`: Bu tarama yapılandırması, hostun durumu ve işletim sistemi bilgileri hakkındaki bilgileri listelemek içindir. Bu tarama yapılandırması güvenlik açıklarını kontrol etmez.  
    
- `Discovery`: Bu tarama yapılandırması, sistem hakkındaki bilgileri numaralandırmak içindir. Yapılandırma, host'un hizmetlerini, donanımını, erişilebilir portlarını ve sistemde kullanılan yazılımları tanımlar. Bu tarama yapılandırması da güvenlik açıklarını kontrol etmez.  
    
- `Host Discovery`: Bu tarama yapılandırması yalnızca hostun canlı olup olmadığını test eder ve ağ üzerinde hangi cihazların `aktif` olduğunu belirler. Bu tarama yapılandırması da güvenlik açıklarını kontrol etmez. _OpenVAS, hostun canlı olup olmadığını belirlemek için ping'den yararlanır._  
    
- `System Discovery`: Bu tarama, hedef hostu ''Discovery Scan''den daha fazla numaralandırır ve host ile ilişkili işletim sistemini ve donanımı tanımlamaya çalışır.  
    
- `Full ve fast`: Bu yapılandırma OpenVAS tarafından en güvenli seçenek olarak önerilir ve erişilebilir portlara dayalı olarak host(lar) için en iyi NVT kontrollerini kullanmak için istihbarattan yararlanır.

'Taramalar' sekmesine gidip sihirbaz simgesine tıklayarak kendi taramanızı oluşturabilirsiniz.

![Pasted image 20241108215420.png](/img/user/resimler/Pasted%20image%2020241108215420.png)

Sihirbaz simgesine tıkladığınızda, aşağıda gösterilen panel açılacak ve taramanızı yapılandırmanıza izin verecektir.

![Pasted image 20241108215434.png](/img/user/resimler/Pasted%20image%2020241108215434.png)

Taramayı `172.16.16.160'ı` hedefleyen aşağıdaki seçeneklerle yapılandıracağız ve ardından bitmesi `30-60 dakika` sürebilecek taramamızı çalıştıracağız.

![Pasted image 20241108215446.png](/img/user/resimler/Pasted%20image%2020241108215446.png)

![Pasted image 20241108215449.png](/img/user/resimler/Pasted%20image%2020241108215449.png)


# **Sonuçları Dışa Aktarma**  

OpenVAS, tarama sonuçlarını aşağıda gösterildiği gibi `Scans (Taramalar` ) sayfasındayken erişilebilen bir rapor halinde sunar.

![Pasted image 20241108215513.png](/img/user/resimler/Pasted%20image%2020241108215513.png)

Rapora tıkladığınızda, tarama sonuçlarını ve işletim sistemi bilgilerini, açık portları, hizmetleri vb. tarama raporundaki diğer sekmelerde görüntüleyebilirsiniz.

![Pasted image 20241108215526.png](/img/user/resimler/Pasted%20image%2020241108215526.png)

## **Formatları Dışa Aktarma**  

Raporlama amacıyla XML, CSV, PDF, ITG ve TXT dahil olmak üzere çeşitli dışa aktarma formatları vardır. Raporunuzu XML olarak dışa aktarmayı seçerseniz, verileri okunması daha kolay bir biçimde görüntülemek için çeşitli XML ayrıştırıcılarından yararlanabilirsiniz.

![Pasted image 20241108215543.png](/img/user/resimler/Pasted%20image%2020241108215543.png)

Sonuçlarımızı XML olarak dışa aktaracağız ve TheGroundZero'nun [openvasreporting](https://github.com/TheGroundZero/openvasreporting) aracını kullanacağız. `Openvasreporting` aracı çıktı oluştururken çeşitli seçenekler sunar. Bu rapor için bir Excel dosyası için standart seçeneği kullanıyoruz.

```shell-session
M1R4CKCK@htb[/htb]$ python3 -m openvasreporting -i report-2bf466b5-627d-4659-bea6-1758b43235b1.xml -f xlsx
```

Bu komut aşağıdakine benzer bir excel belgesi oluşturacaktır:

![Pasted image 20241108215610.png](/img/user/resimler/Pasted%20image%2020241108215610.png)

![Pasted image 20241108215613.png](/img/user/resimler/Pasted%20image%2020241108215613.png)


# OpenVAS Skills Assessment

Soru : Linux host ne tür bir işletim sistemi çalıştırıyor? (tek kelime)
Cevap : Ubuntu 

![Pasted image 20241109013831.png](/img/user/resimler/Pasted%20image%2020241109013831.png)


Soru 2 : Linux hostta ne tür bir FTP güvenlik açığı var? (Büyük/Küçük Harfe Duyarlı, dört kelime)
Cevap : Anonymous FTP Login Reporting

![Pasted image 20241109013932.png](/img/user/resimler/Pasted%20image%2020241109013932.png)

Soru 3 : Tarama için hedeflenen Linux hostunun IP'si nedir?
Cevap : 
![Pasted image 20241109014002.png](/img/user/resimler/Pasted%20image%2020241109014002.png)


Soru 4 : HTTP sunucusuyla ilişkili güvenlik açığı nedir? (Harfe duyarlı)
Cevap : Cleartext Transmission of Sensitive Information via HTTP

![Pasted image 20241109014227.png](/img/user/resimler/Pasted%20image%2020241109014227.png)


# **Raporlama**  

Bilgi güvenliği alanındaki sosyal beceriler, rolünüzde başarılı olmanız için kritik öneme sahiptir. Güvenlik açığı tarama araçları otomatik araçlardan yararlanıyor olsa da, bilgilerin müşteriye hazır bir rapora aktarılmasına ihtiyaç vardır. Rapor, teknik bir kişiden teknik olmayan bir kişiye kadar herkes tarafından okunabilir olmalıdır. Güçlü bir rapor aşağıdaki bölümlerden oluşur:  

- Yönetici Özeti  
- Değerlendirmeye Genel Bakış  
- Kapsam  
- Güvenlik Açıkları ve Öneriler


## **Yönetim Özeti**  

Bir güvenlik açığı değerlendirme raporunun `Executive Summary (Yönetici Özeti` ) `bölümünün`, ayrıntılara ve önem derecesine bağlı olarak derhal düzeltilmesi gereken en önemli öğelerin neler olduğuna dair üst düzey bir genel bakışa ihtiyaç duyan bir yönetici tarafından okunabilir olması amaçlanmıştır. Bu bölüm, bir yöneticinin rapora bakmasına ve özete dayanarak düzeltmeleri önceliklendirmesine olanak tanır.  

Ayrıca, aşağıdaki grafiğe benzer şekilde, önem derecesine göre güvenlik açığı sayısının grafiksel bir görünümünü de buraya ekleyebilirsiniz:

![Pasted image 20241109014443.png](/img/user/resimler/Pasted%20image%2020241109014443.png)

## **Değerlendirmeye Genel Bakış**  

`Değerlendirmeye Genel Bakış`, değerlendirme sırasında yararlanılan tüm metodolojileri içermelidir. Metodoloji, proje için kullanılan süreç ve araçların (örn. Nessus) tartışılması gibi test dönemi boyunca değerlendirmenin yürütülmesini detaylandırmalıdır.  

## **Kapsam ve Süre**  

Raporun `Kapsam ve Süre` bölümü, hedef kapsam ve test süresi de dahil olmak üzere müşterinin değerlendirme için yetkilendirdiği her şeyi içermelidir.

## **Güvenlik Açıkları ve Öneriler**  

`Güvenlik Açıkları ve Öneriler` bölümü, manuel olarak test ederek yanlış pozitifleri ortadan kaldırdıktan sonra güvenlik açığı değerlendirmesi sırasında keşfedilen bulguları detaylandırmalıdır. Birbiriyle ilişkili bulguları, sorunların türüne veya önem derecelerine göre gruplandırmak en iyisidir.  

Her sorun aşağıdaki unsurlara sahip olmalıdır:  

- Güvenlik Açığı Adı  
- CVE  
- CVSS  
- Konunun Açıklaması  
- Referanslar  
- İyileştirme Adımları  
- Kavram Kanıtı  
- Etkilenen Sistemler  
    

## **Kapanış**  

Herhangi bir değerlendirmenin raporlama bölümü projenin en önemli kısmıdır. Raporlarınızı her zaman herhangi bir kitlenin okuyabileceği şekilde yazdığınızdan emin olun. Teknik bilgileri tartışırken, okuyucunun raporda ne hakkında konuştuğunuzu anlaması veya yeniden üretmesi için her zaman açıkladığınız şeye referans verin. Ayrıca, cümleler doğru dilbilgisi kurallarına uygun olmalıdır. En güçlü raporlar bir okuyucu için kısa ve nettir.
